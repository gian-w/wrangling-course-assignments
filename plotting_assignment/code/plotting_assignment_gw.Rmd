---
title: "Plotting Assignment - "
author: "Gian Wegmueller"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    code_folding: show
    highlight: haddock
    theme: flatly
    toc: yes
    toc_float: yes
---

```{r, include=FALSE}

# set knit options
knitr::opts_chunk$set(message = FALSE,
                      warning = FALSE)

# disable scientific notation
options(scipen = 999) 


```

# Dependencies

```{r}

# update dependencies -> only include necessary packages

library(readr)
library(dplyr)
library(tidyr)
library(janitor)
library(ggplot2)


library(datasauRus) 
library(scales)

library(plotrix) 
library(ThemePark)
library(patchwork)

library(knitr)
library(kableExtra)

```


# Data exploration (temporary, should not be included in final file)

```{r Data exploration}
## Drug use data
drugs_raw <- read_csv("../data/drug_use_by_age.csv")

summary(drugs_raw)

```

## Data Preparation Drug Use

```{r Data prep}
drugs_comparison <- drugs_raw %>% 
  select(age, n, 
         starts_with(c("alcohol", "marijuana", "cocaine", "meth"))) %>% 
  filter(age %in% c("21", "22-23", "24-25", "26-29", "50-64")) %>% #choosing only legal drinking-age millenials for comparison here!
  mutate(cocaine_frequency = as.numeric(cocaine_frequency),
         meth_frequency = as.numeric(meth_frequency),
         generation = if_else(age == "50-64", "Boomer", "Millennial")) %>% 
  group_by(generation) %>% 
  summarize(alc_freq_med = janitor::round_half_up(weighted.mean(alcohol_frequency, n), 1),
            pot_freq_med = janitor::round_half_up(weighted.mean(marijuana_frequency, n), 1),
            coke_freq_med = janitor::round_half_up(weighted.mean(cocaine_frequency, n), 1),
            meth_freq_med = janitor::round_half_up(weighted.mean(meth_frequency, n), 1))

```

```{r Mann-Whitney-U Test}
wilcox.test()


```




# Session info

```{r}

sessionInfo()

```
